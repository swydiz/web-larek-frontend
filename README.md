# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Компоненты

1. Слой Моделей. 

    Классы:
    - ProductModel: Управляет данными о товарах.
    Назначение: Предоставляет методы для получения и обработки информации о товарах.
    Зона ответственности:
    Хранение массива с атрибутами карточек товаров.
    Предоставление методов для доступа к данным о товарах.
    Обработка данных о товарах.
    Конструктор:
    products: Product[] - Массив товаров.
    eventEmitter: EventEmitter - Экземпляр класса EventEmitter для обмена событиями.
    Методы:
    getProducts(): Product[] - Возвращает массив товаров.
    getProductById(id: number): Product | undefined - Возвращает конкретный товар из массива.

    - CartModel: Управляет данными корзины.
    Назначение: Предоставляет методы для добавления, удаления и обновления товаров в корзине.
    Зона ответственности:
    Хранение товаров в корзине.
    Подсчет общей стоимости.
    Поля:
    items: CartItem[] - Содержит товары в корзине.
    Методы:
    addItem(product: Product): void - Добавляет товар в корзину.
    removeItem(productId: number): void - Удаляет товар из корзины.
    getTotalPrice(): number - Подсчитывает общую стоимость товаров в корзине.

    - CheckoutModel: Управляет данными оформления заказа и обрабатывает заказ.
    Назначение: Предоставляет методы для проверки информации о заказе и отправки заказа.
    Зона ответственности:
    Проверка адреса доставки, email и телефона покупателя.
    Поля:
    shippingAddress: string - Содержит адрес доставки.
    customerEmail: string - Содержит email покупателя.
    customerPhone: string - Содержит телефон покупателя.
    paymentMethod: string - Содержит выбранный способ оплаты
    Методы:
    validateShippingAddress(address: string): boolean - Проверяет адрес доставки.
    validateCustomerInfo(email: string, phone: string, paymentMethod: string): boolean - Проверяет email, телефон покупателя и способ оплаты.


2. Слой Отображения 
Слой отображения отвечает за отрисовку пользовательского интерфейса и обработку взаимодействий пользователя.

    Классы:
    - MainPageView: Отображает главную страницу с каталогом товаров.
    Назначение: Отображение списка товаров и элементов управления главной страницы (кнопка корзины, счетчик товаров).
    Зона ответственности:
    Отображение списка товаров на главной странице.
    Отображение счетчика товаров в корзине.
    Обработка клика по иконке корзины.
    Поля:
    productListContainer: HTMLElement - Контейнер для отображения списка товаров.
    basketCounterElement: HTMLElement - Элемент для отображения количества товаров в корзине.
    basketIconElement: HTMLElement - Элемент иконки корзины.
    eventEmitter: EventEmitter - Экземпляр класса `EventEmitter` для обмена событиями.
    Методы:
    render(productElements: HTMLElement[]): void - Отрисовывает список товаров на экране, принимая массив HTML-элементов карточек.
    setBasketCount(count: number): void - Обновляет счетчик товаров в корзине.

    - CartView: Отображает корзину с товарами.
    Назначение: Отображение списка товаров в корзине и общей стоимости.
    Зона ответственности:
    Отображение списка товаров в корзине.
    Отображение общей стоимости.
    Получение обновленного списка HTML-элементов товаров и общей стоимости извне (через обработчики событий).
    Поля:
    cartItemsContainer: HTMLElement - Контейнер для отображения списка товаров в корзине.
    totalPriceElement: HTMLElement - Элемент для отображения общей стоимости.
    eventEmitter: EventEmitter - Экземпляр класса EventEmitter для обмена событиями.
    Методы:
    render(cartItemElements: HTMLElement[], totalPrice: number): void - Отрисовывает список товаров в корзине и общую стоимость, принимая массив HTML-элементов карточек.
    setTotalPrice(totalPrice: number): void - Устанавливает общую цену в корзине.

    - Card: Отображает карточку товара.
    Назначение: Создание и отображение HTML-элемента карточки товара с заданными данными и шаблоном.
    Зона ответственности:
    Создание HTML-элемента карточки товара на основе шаблона.
    Заполнение данных карточки (название, изображение, цена и описание).
    Привязка обработчика событий к конкретному интерактивному элементу
    Поля:
    template: HTMLTemplateElement - Шаблон HTML для карточки.
    data: Product | CartItem - Данные товара или элемента корзины.
    onAction?: (actionType: string, event: Event) => void - Функция обратного вызова, которая будет вызвана при наступлении определенного действия внутри карточки
    Методы:
    render(): HTMLElement - Создает и возвращает HTML-элемент карточки товара, заполненный данными. В этом методе происходит поиск элементов внутри шаблона (например, `.card__title`, `.card__image`, `.card__price`) и установка их значений на основе данных товара.

    - Form: Абстрактный класс для форм.
    Назначение: Предоставляет базовую функциональность для отображения формы и взаимодействия с ней 
    Зона ответственности:
    Отображение формы.
    Обработка событий input и submit на элементах формы.
    Блокировка/разблокировка кнопки отправки (submit) на основе данных, полученных из модели (через EventEmitter).
    Передача данных формы в модель (через EventEmitter) для валидации.
    Поля:
    form: HTMLFormElement - Элемент формы.
    submitButton: HTMLButtonElement - Кнопка отправки формы.
    eventEmitter: EventEmitter - Экземпляр класса EventEmitter для обмена событиями.
    Методы:
    handleSubmit(event: Event): void - Обработчик события submit (отправки формы). Отправляет данные формы в модель для валидации через eventEmitter и блокирует кнопку отправки.
    handleInputChange(event: Event): void - Обработчик события input (изменения значения поля ввода). Передает данные поля ввода в модель для валидации через eventEmitter
    setSubmitButtonState(isValid: boolean): void - Устанавливает состояние кнопки отправки (включена или отключена), применяя соответствующие стили CSS.

    - ContactInfoView: Отображает форму для ввода контактной информации (email, телефон).
    Назначение: Отображение формы для ввода контактной информации и взаимодействие с ней
    Зона ответственности:
    Отображение полей формы для email, телефона.
    Обработка событий input и submit на форме.
    Блокировка/разблокировка кнопки отправки (submit) на основе данных, полученных из модели (через EventEmitter).
    Передача данных формы в модель (через EventEmitter) для валидации.
    Поля:
    emailInput: HTMLInputElement - Поле ввода для email.
    phoneInput: HTMLInputElement - Поле ввода для телефона.
    Методы:
    handleSubmit(event: Event): void - Обработчик события submit (отправки формы). Отправляет данные формы в модель для валидации через eventEmitter и блокирует кнопку отправки.
    handleInputChange(event: Event): void - Обработчик события input (изменения значения поля ввода). Передает данные поля ввода в модель для валидации через eventEmitter
    setSubmitButtonState(isValid: boolean): void - Устанавливает состояние кнопки отправки (включена или отключена), применяя соответствующие стили CSS.

    - DeliveryAddressView: Отображает форму для ввода адреса доставки и способа оплаты.
    Назначение: Отображение формы для ввода адреса доставки и выбора способа оплаты, а также взаимодействие с ней
    Зона ответственности:
    Отображение поля для ввода адреса доставки и способа оплаты.
    Обработка событий input, click (на элементах выбора способа оплаты) и submit на форме.
    Блокировка/разблокировка кнопки отправки (submit) на основе данных, полученных из модели (через EventEmitter).
    Передача данных формы в модель (через EventEmitter) для валидации.
    Поля:
    shippingAddressInput: HTMLInputElement - Поле ввода для адреса доставки.
    paymentMethodSelect: HTMLSelectElement - Выбор способа оплаты.
    Методы:
    handleSubmit(event: Event): void - Обработчик события submit. Отправляет данные формы в модель для валидации через eventEmitter и блокирует кнопку отправки.
    handleInputChange(event: Event): void - Обработчик события input (изменения значения поля ввода). Передает данные поля ввода в модель для валидации через eventEmitter
    handlePaymentMethodClick(event: Event): void - Обработчик события click на кнопках выбора способа оплаты. Передает выбранный способ оплаты в модель для валидации через eventEmitter
    setSubmitButtonState(isValid: boolean): void - Устанавливает состояние кнопки отправки (включена или отключена), применяя соответствующие стили CSS.

    - SuccessView: Отображает сообщение об успешном оформлении заказа.
    Назначение: Отображение сообщения об успешном оформлении заказа.
    Зона ответственности:
    Отображение сообщения об успехе.
    Поля:
    successContainer: HTMLElement - Элемент, содержащий сообщение об успехе.
    Методы:
    render(): void - Отображает сообщение об успехе.
    hide(): void - Скрывает сообщение об успехе.

    - ModalView: Отображает модальное окно.
    Назначение: Отображение модальных окон с различным контентом.
    Зона ответственности:
    Отображение контента внутри модального окна.
    Открытие и закрытие модального окна.
    Поля:
    modalContainer: HTMLElement - Элемент, содержащий HTML модального окна.
    modalContentContainer: HTMLElement - Контейнер внутри модального окна
    closeButton: HTMLButtonElement - Кнопка закрытия модального окна.
    Методы:
    setContent(content: HTMLElement): void - Устанавливает контент модального окна. Метод принимает HTMLComponent и вставляет его в modalContentContainer.
    open(): void - Открывает модальное окно.
    close(): void - Закрывает модальное окно.

3. Слой Презентеров 
    Слой презентеров выступает в роли посредника между слоями моделей и отображения. Он получает действия пользователя из слоя отображения и координирует работу других классов для обновления модели и отображения новых данных.


4. Брокер Событий (Event Broker)
    Брокер событий отвечает за обеспечение взаимодействия между различными частями приложения.Используется существующий класс EventEmitter.

5. API Service
    Класс APIService управляет взаимодействием с внешним API. Используется существующий класс Api.

6. Поток Данных
    - Начальная загрузка:
        Инициализация в index.ts (или Presenter)
        Передача данных в ProductModel
        Обработка данных в ProductModel
        ProductModel генерирует событие productsLoaded, передавая в него данные о товарах.
        Отображение данных в MainPageView

    - Добавление в корзину:
        Card генерирует событие addToCart при клике на кнопку “Добавить в корзину”.
        index.ts (или Presenter) обрабатывает событие addToCart.
        index.ts (или Presenter) вызывает метод addItem() класса CartModel.
        CartModel обновляет корзину и генерирует событие cartUpdated.
        index.ts (или Presenter) получает событие cartUpdated и:
        Создает экземпляры Card для товаров в корзине.
        Передает HTML-элементы карточек в CartView.
        Обновляет общую стоимость в CartView.
        Обновляет счетчик товаров в корзине в MainPageView.

    - Оформление заказа:
        index.ts (или Presenter) создает экземпляр DeliveryAddressView и вызывает метод render() класса MainPageView, передавая ему экземпляр DeliveryAddressView для отображения формы с адресом доставки.
        DeliveryAddressView генерирует событие validateForm при отправке формы с адресом доставки.
        index.ts (или Presenter) обрабатывает событие validateForm.
        index.ts (или Presenter) создает экземпляр ContactInfoView и вызывает метод render() класса MainPageView, передавая ему экземпляр ContactInfoView для отображения формы с контактной информацией.
        ContactInfoView генерирует событие validateForm при отправке формы с адресом доставки.
        index.ts (или Presenter) обрабатывает событие validateForm.
        index.ts (или Presenter) отправляет данные заказа (включая контактную информацию и адрес доставки) в APIService. 
        APIService отправляет данные заказа на сервер.
        index.ts (или Presenter) получает ответ от сервера (успех или ошибка) и создает экземпляр класса SuccessView (ErrorView) вызывает метод render() класса MainPageView, передавая ему экземпляр для отображения сообщения.

7. Пример взаимодействия
    Пользователь добавляет товар в корзину:
        Класс Card реагирует на клик пользователя по кнопке “Добавить в корзину” и генерирует событие addToCart.
        В index.ts происходит обработка события addToCart.
        В index.ts вызывается метод addItem() класса CartModel, передавая ID товара.
        Класс CartModel добавляет товар в корзину и обновляет данные корзины.
        Класс CartModel генерирует событие cartUpdated.
        В index.ts происходит обработка события cartUpdated.
        В index.ts вызывается метод render() класса CartView, чтобы обновить отображение корзины с новыми данными.
        В index.ts вызывается метод setBasketCount класса MainPageView для обновления счетчика корзины.
